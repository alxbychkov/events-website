"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Calendar=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.container=document.querySelector(t),this.parent=this.container.parentNode,this.selectedDay="",this.scrollX=28,this.data=n}return _createClass(e,[{key:"prepare",value:function(){var e=new Date;this.selectedMonthNum=e.getMonth(),this.year=e.getFullYear(),this.printCalendar(),this.months=this.container.querySelector(".calentar-months"),this.month=this.months.querySelectorAll('[data-type="month"]'),this.screen=this.container.querySelector('[data-type="screen"]'),this.mobMonth=this.months.querySelector('[data-type="mobile-month"]'),this.screen.innerHTML=this.createCalendarDays(e.getMonth())}},{key:"init",value:function(){this.prepare(),this.listeners()}},{key:"listeners",value:function(){var e=this;this.container.addEventListener("click",(function(t){var n=t.target;if(n.dataset.controls){var a=e.screen.offsetWidth,r=e.screen.scrollWidth,o=e.screen.scrollLeft;switch(n.dataset.controls){case"prev":o>0&&(e.screen.scrollLeft=e.screen.scrollLeft-e.scrollX);break;case"next":a+o<r&&(e.screen.scrollLeft=e.screen.scrollLeft+e.scrollX)}}})),this.screen.addEventListener("wheel",(function(e){if(e.deltaMode==e.DOM_DELTA_PIXEL)var t=1;else if(e.deltaMode==e.DOM_DELTA_LINE)t=4;else if(e.deltaMode==e.DOM_DELTA_PAGE)t=this.clientHeight;0!=e.deltaY&&(this.scrollLeft+=t*e.deltaY,e.preventDefault())})),this.month.forEach((function(t){t.addEventListener("click",(function(t){var n=t.target,a=n.innerHTML;e.month.forEach((function(e){return e.classList.contains("active")&&e.classList.remove("active")})),n.classList.contains("active")||n.classList.add("active"),e.mobMonth.innerHTML=a,e.mobMonth.classList.contains("open")&&e.mobMonth.classList.remove("open"),e.selectedMonthNum=n.dataset.month,e.screen.innerHTML=e.createCalendarDays(e.selectedMonthNum),e.screen.scrollLeft=0}))})),this.screen.addEventListener("click",(function(t){var n=t.target;if(n.classList.contains("busy")||n.parentNode.classList.contains("busy")){var a=n.classList.contains("busy")?n:n.parentNode;e.screen.querySelectorAll('[data-type="date"]').forEach((function(e){e!==a&&e.classList.contains("active")&&e.classList.remove("active")})),a.classList.contains("active")?a.classList.remove("active"):a.classList.add("active"),e.selectedDay=a.dataset.day}})),this.mobMonth.addEventListener("click",(function(e){var t=e.target;t.classList.contains("open")?e.target.classList.remove("open"):t.classList.add("open")}))}},{key:"createCalendarHeader",value:function(){var e=this,t={0:"январь",1:"февраль",2:"март",3:"апрель",4:"май",5:"июнь",6:"июль",7:"август",8:"сентябрь",9:"октябрь",10:"ноябрь",11:"декабрь"},n=document.createElement("div");n.classList.add("calentar-months");var a=[];Object.values(t).forEach((function(t,n){var r=e.selectedMonthNum===n?" active":"",o='<li class="month'.concat(r,'" data-type="month" data-month="').concat(n,'">').concat(t,"</li>");a.push(o)}));var r='\n            <p class="month month__mobile" data-type="mobile-month">'.concat(t[this.selectedMonthNum],'</p>\n            <ul class="months" data-type="months">').concat(a.join(""),'</ul>\n            <p class="year" data-type="year">').concat(this.year,"</p>\n        ");return n.innerHTML=r,n}},{key:"createCalendarScreen",value:function(){var e=document.createElement("div");return e.classList.add("calendar-dates"),e.id="dates",e.dataset.type="dates",e.innerHTML='<div class="dates-wrapper" data-type="screen"></div>',e}},{key:"createCalendarDays",value:function(e){for(var t=this.data[+e+1]?this.data[+e+1]:"",n=["вс","пн","вт","ср","чт","пт","сб"],a=[],r=32-new Date(this.year,e,32).getDate(),o=new Date(this.year,e).getDay(),s=1;s<r+1;s++){var i=t.includes(s)?" busy":"",l=6===o||0===o?" weekend":"",c='\n            <div class="date__item'.concat(i,'" data-type="date" data-day="').concat(s,'">\n                <p class="date__number">').concat(s,'</p>\n                <p class="date__letter').concat(l,'">').concat(n[o],"</p>\n            </div>\n            ");6===o?o=0:o++,a.push(c)}return a.join("")}},{key:"createCalendarNav",value:function(){return'\n            <button type="button" class="dates__nav" data-controls="prev" tabindex="-1" aria-controls="dates">\n                <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg" data-controls="prev"><path d="M6 1L1 6L6 11" stroke="#7B7B7B" data-controls="prev"/></svg>\n            </button>\n            <button type="button" class="dates__nav" data-controls="next" tabindex="-1" aria-controls="dates">\n                <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg" data-controls="next"><path d="M1 11L6 6L1 1" stroke="#7B7B7B" data-controls="next"/></svg>\n            </button>\n        '}},{key:"printCalendar",value:function(){this.container.insertAdjacentHTML("beforeend",this.createCalendarNav()),this.container.insertAdjacentElement("afterbegin",this.createCalendarScreen()),this.container.insertAdjacentElement("afterbegin",this.createCalendarHeader())}}]),e}();function add_to_data_profile(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none",t=arguments.length>1?arguments[1]:void 0,n="object"===_typeof(t)?t.dataset.event:t,a={id:n,method:e};if("none"!==e&&t)return new Promise((function(n,r){fetch("/local/ajax/profileHandlers.php",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(r){if(1===r)"favourite"===e?(t.classList.contains("full")||t.classList.add("full"),addClass(document.querySelectorAll('[data-type="favourite"][data-event="'.concat(a.id,'"]')),"full"),document.querySelector('button[data-type="favourite"][data-event="'.concat(a.id,'"]'))&&(document.querySelector('button[data-type="favourite"][data-event="'.concat(a.id,'"]')).innerHTML="Убрать из избранного"),"undefined"!=typeof ym&&ym(80017873,"reachGoal","favorite")):"follow"===e?(document.querySelectorAll('[data-type="follow"][data-event="'.concat(a.id,'"]')).forEach((function(e){e.innerHTML="Отменить запись",e.classList.contains("unfollow")||e.classList.add("unfollow")})),showBundle("Вы успешно записались на мероприятие.<br>Теперь оно появится в личном кабинете<br>и мы напомним Вам о нем.")):"play"===e&&(t.dataset.action="played",addClass(document.querySelectorAll('[data-type="visit"][data-event="'.concat(a.id,'"]')),"full"));else if(2===r)"favourite"===e?(t.classList.contains("full")&&t.classList.remove("full"),removeClass(document.querySelectorAll('[data-type="favourite"][data-event="'.concat(a.id,'"]')),"full"),document.querySelector('button[data-type="favourite"][data-event="'.concat(a.id,'"]'))&&(document.querySelector('button[data-type="favourite"][data-event="'.concat(a.id,'"]')).innerHTML="в избранное")):"follow"===e&&(document.querySelectorAll('[data-type="follow"][data-event="'.concat(a.id,'"]')).forEach((function(e){e.innerHTML="Записаться",e.classList.contains("unfollow")&&e.classList.remove("unfollow")})),showBundle("Вы отменили запись на мероприятие.","attention"));else if(3===r){var o=encodeURIComponent(window.location.pathname);window.open("/login/?backurl=".concat(o,"&method=new").concat(e,"&event=").concat(a.id,"#noauth"),"_blank")}n(r)}))}))}function showBundle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement("div");n.classList.add("popup-bundle");var a=document.createElement("div");a.classList.add("bundle__icon"),""!==t&&a.classList.add(t);var r=document.createElement("p");r.classList.add("bundle__text"),r.innerHTML=e,n.appendChild(a),n.appendChild(r);var o=document.querySelector("body");o.insertAdjacentElement("beforeend",n),setTimeout((function(){n.classList.add("closing"),setTimeout((function(){n.remove()}),1e3)}),3e3)}function subscribe(e){e&&fetch("/local/ajax/subscribe.php",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){1===e?(showBundle("Мы отправили вам письмо.<br>Пожалуйста, проверьте вашу почту."),"undefined"!=typeof ym&&ym(80017873,"reachGoal","subscribe")):2===e&&showBundle("Ваш e-mail уже есть в базе.","error")}))}function toggleOpen(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(e.length>0&&""!=t))return!1;e.forEach((function(e){e.classList.contains(t)&&e.classList.remove(t)}))}function addClass(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(e.length>0&&""!=t))return!1;e.forEach((function(e){e.classList.contains(t)||e.classList.add(t)}))}function removeClass(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(e.length>0&&""!=t))return!1;e.forEach((function(e){e.classList.contains(t)&&e.classList.remove(t)}))}function toggleClass(e,t){void 0!==e.length?e.forEach((function(e){return e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)})):e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}function currentDateEvents(e){var t=document.createElement("section");t.classList.add("section","month-events"),t.dataset.date="".concat(e.day,".").concat(e.month+1,".").concat(e.year);var n=new Date(e.year,e.month,e.day),a=n.toLocaleString("ru",{month:"long",day:"numeric"}),r={day:n.toLocaleDateString("ru")};if("undefined"!=typeof BX)return new Promise((function(n,o){var s=BX.showWait(e.parent);BX.ajax.post("/local/ajax/currentDayEvents.php",r,(function(r){t.innerHTML='\n                        <h2 class="section__title">Мероприятия '.concat(a,'</h2>\n                        <div class="events__wrapper">').concat(r,"</div>\n                    "),document.querySelector("[data-date]")?document.querySelector("[data-date]").replaceWith(t):e.parent.insertAdjacentElement("afterEnd",t),BX.closeWait(e.parent,s),n(!0)}))}))}function load_more_results(e,t){if("undefined"!=typeof BX){var n=BX.showWait(e.parentNode),a='[data-type="list"]';e.dataset.id&&(a='[data-id="'.concat(e.dataset.id,'"]')),BX.ajax({type:"GET",url:t,dataType:"html",onsuccess:function(t){"more"===e.nextElementSibling.dataset.type&&e.nextElementSibling.remove();var r=(new DOMParser).parseFromString(t,"text/html"),o=_toConsumableArray(r.querySelector(a).children),s="";o.forEach((function(e){return s+=e.outerHTML}));var i=r.querySelector(a).nextElementSibling;e.insertAdjacentHTML("beforeEnd",s),e.insertAdjacentElement("afterEnd",i),e.dataset.id&&window.monthSliders.push(initSlider(e)),BX.closeWait(e.parentNode,n)}})}}function change_events(e,t){"undefined"!=typeof BX&&BX.ajax({type:"GET",url:"/personal/",dataType:"html",onsuccess:function(n){var a=(new DOMParser).parseFromString(n,"text/html"),r="",o="",s=!1;switch(e){case"follow":(o=a.querySelector("#signedEventsSlider"))||(s=!0,o=a.querySelector('[data-type="no-signed-events"]')),r=document.querySelector('[data-type="signed-events"]');break;case"favorite":(o=a.querySelector("#eventsSlider"))||(s=!0,o=a.querySelector('[data-type="no-favorite-events"]')),r=document.querySelector('[data-type="favorite-events"]')}if(r.lastElementChild.replaceWith(o),s||void 0===t||t.rebuild(),void 0===t&&!s)if("follow"===e)initSlider("#signedEventsSlider");else if("favorite"===e)initSlider("#eventsSlider")}})}function initSlider(e){return tns({container:e,items:1,slideBy:1,autoplay:!1,autoplayText:["",""],controlsText:['\n            <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M6 1L1 6L6 11" stroke="#7B7B7B"/>\n            </svg>','\n            <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M1 11L6 6L1 1" stroke="#7B7B7B"/>\n            </svg>\n        '],autoWidth:!1,autoplayButton:!1,gutter:20,nav:!1,arrowKeys:!0,autoplayHoverPause:!0,mouseDrag:!0,touch:!0,preventScrollOnTouch:"auto",swipeAngle:45,edgePadding:15,responsive:{475:{items:2},561:{disable:!0}}})}function validateForm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||"object"!==_typeof(t)||0===t.length)return!1;var n=!0,a=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return t.forEach((function(t){var r=e.querySelector('input[name="'.concat(t,'"]'));if(r)switch(t){case"name":""==r.value||r.value.length<2?(n=!1,addClass([r],"error__input")):removeClass([r],"error__input");break;case"company":""==r.value||r.value.length<3?(n=!1,addClass([r],"error__input")):removeClass([r],"error__input");break;case"email":0==a.test(r.value)?(n=!1,addClass([r],"error__input")):removeClass([r],"error__input");break;case"check":!1===r.checked?(n=!1,addClass([r],"error__input")):removeClass([r],"error__input");break;case"text":""!==r.value&&0!==r.value.length&&(n=!1)}})),n}function debounce(e,t,n){var a;return function(){var r=this,o=arguments,s=function(){a=null,n||e.apply(r,o)},i=n&&!a;clearTimeout(a),a=setTimeout(s,t),i&&e.apply(r,o)}}function debouncePromise(e){var t,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[];return function(){for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return new Promise((function(o,i){clearTimeout(t),t=setTimeout((function(){var t=[].concat(r);r.length=0,Promise.resolve(e.apply(n,s)).then((function(e){t.forEach((function(t){return(0,t.resolve)(e)}))}),(function(e){t.forEach((function(t){return(0,t.reject)(e)}))}))}),a),r.push({resolve:o,reject:i})}))}}function validate_reg_form(e){var t=document.querySelector('form[name="regform"]');if(!t)return!1;var n=t.querySelector('input[name="REGISTER[EMAIL]"]'),a=t.querySelector('input[name="REGISTER[PASSWORD]"]'),r=t.querySelector('input[name="REGISTER[CONFIRM_PASSWORD]"]'),o=t.querySelector('input[name="REGISTER[NAME]"]'),s=t.querySelector('input[name="captcha_word"]'),i=document.querySelector('[data-type="error"]');return!(!e||""===e)&&((e=e.split(",")).forEach((function(e){switch(e){case"EMAIL":n&&addClass([n],"error__input");break;case"PASSWORD":a&&addClass([a],"error__input");break;case"CONFIRM_PASSWORD":r&&addClass([r],"error__input");break;case"DIFFERENT":r&&a&&(addClass([r],"error__input"),addClass([a],"error__input"));break;case"NAME":o&&addClass([o],"error__input");break;case"CAPTCHA":s&&addClass([s],"error__input")}})),i&&removeClass([i],"hidden"),!0)}function changeBackground(){var e=document.querySelectorAll("[data-bg]");if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t].getAttribute("data-bg");e[t].style.backgroundImage="url("+n+")"}}function videoCheck(e){return!(!e||"VIDEO"!==e.tagName)&&new Promise((function(t,n){e.addEventListener("timeupdate",(function e(n){var a=n.target.duration/2;n.target.currentTime>a&&(n.target.removeEventListener("timeupdate",e),t(1))}))}))}function not_auth_user(){-1!==window.location.hash.indexOf("noauth")&&(showBundle("Пожалуйста авторизуйтесь на сайте!","error"),window.location.hash="")}function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}document.addEventListener("DOMContentLoaded",(function(){if(document.querySelector("#calendar")){var e=new Calendar("#calendar",allEvents);e.init()}if(document.getElementById("mainSlider")){var t=tns({container:"#mainSlider",items:1,slideBy:1,autoplay:!1,autoplayTimeout:1e4,autoplayText:["",""],controlsText:['\n                <svg width="9" height="16" viewBox="0 0 9 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M8.38114 1.33331L1.23828 8.47617L8.38114 15.619" stroke="white"/></svg>','\n                <svg width="9" height="16" viewBox="0 0 9 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M0.618862 14.6667L7.76172 7.52383L0.61886 0.380973" stroke="white"/>\n                </svg>\n            '],controls:!1,autoWidth:!0,autoplayButton:!1,gutter:20,nav:!0,arrowKeys:!0,autoplayHoverPause:!0,preventScrollOnTouch:"auto",touch:!0,mouseDrag:!0,swipeAngle:45,center:!1,loop:!0,responsive:{610:{items:3,nav:!1,controls:!0,slideBy:"page",center:!0,gutter:20},991:{center:!1,gutter:20}},useLocalStorage:!1});t.events.on("touchEnd",(function(e){if(e.index===e.slideCountNew-1)for(var n=0;n<e.cloneCount;n++)t.goTo("prev")}))}if(document.getElementById("eventsSlider"))var n=initSlider("#eventsSlider");if(document.getElementById("signedEventsSlider"))var a=initSlider("#signedEventsSlider");if(document.getElementById("attendedEventsSlider"))initSlider("#attendedEventsSlider");if(document.getElementById("speakerEventsSlider"))n=initSlider("#speakerEventsSlider");if(document.getElementById("speakersSlider"))n=tns({container:"#speakersSlider",items:1,slideBy:1,autoplay:!1,autoplayText:["",""],controlsText:['\n                <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M6 1L1 6L6 11" stroke="#7B7B7B"/>\n                </svg>','\n                <svg width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M1 11L6 6L1 1" stroke="#7B7B7B"/>\n                </svg>\n            '],autoWidth:!1,autoplayButton:!1,gutter:20,nav:!1,arrowKeys:!0,autoplayHoverPause:!0,mouseDrag:!0,touch:!0,preventScrollOnTouch:"auto",swipeAngle:45,edgePadding:15,responsive:{610:{disable:!0}}});document.querySelectorAll(".monthSlider").length>0&&(window.monthSliders=[],document.querySelectorAll(".monthSlider").forEach((function(e,t){window.monthSliders.push(initSlider(e)),void 0!==window.monthSliders[t]&&1===window.monthSliders[t].getInfo().slideCount&&window.monthSliders[t].destroy()}))),window.addEventListener("resize",(function(){window.innerWidth<610&&c&&c.classList.contains("open")&&toggleOpen([c,d],"open"),window.innerWidth<610&&t&&t.refresh()})),window.addEventListener("orientationchange",(function(e){e.target.screen.orientation}));var r=document.querySelector(".main"),o=!1,s=null!==document.querySelector(".active[data-month]")?document.querySelector(".active[data-month]").dataset.month:0;r&&r.addEventListener("click",(function(t){var i=t.target;if("follow"===i.dataset.type&&(t.preventDefault(),"profile"===r.dataset.type?add_to_data_profile(i.dataset.type,i).then((function(){change_events("follow",a)})):add_to_data_profile(i.dataset.type,i)),"favourite"===i.dataset.type&&(t.preventDefault(),"profile"===r.dataset.type?add_to_data_profile(i.dataset.type,i).then((function(){change_events("favorite",n)})):add_to_data_profile(i.dataset.type,i)),"visit"===i.dataset.type&&(t.preventDefault(),i.dataset.href&&window.open(i.dataset.href,"_blank")),i.classList.contains(".slider__head")&&t.preventDefault(),"date"===i.dataset.type&&i.classList.contains("busy")||"date"===i.parentNode.dataset.type&&i.parentNode.classList.contains("busy")){var l=r.querySelector('[data-type="key-events"]'),c=r.querySelector(".main__events");if(i.classList.contains("active")||i.parentNode.classList.contains("active"))currentDateEvents({parent:e.parent,day:e.selectedDay,month:e.selectedMonthNum,year:e.year}).then((function(e){e&&(l&&!l.classList.contains("hidden")&&l.classList.add("hidden"),c&&c.querySelector(".section__title")&&!o&&(c.querySelector(".section__title").innerHTML="Вас может заинтересовать",o=!0))}));else document.querySelector("section[data-date]")&&document.querySelector("section[data-date]").remove(),l&&l.classList.contains("hidden")&&l.classList.remove("hidden"),c&&c.querySelector(".section__title")&&o&&(c.querySelector(".section__title").innerHTML="Ключевые мероприятия",o=!1)}if(i.dataset.month&&"month"===i.dataset.type&&s!==i.dataset.month){s=i.dataset.month;var d=r.querySelector(".main__events"),u={month:i.dataset.month};if(void 0!==("undefined"==typeof BX?"undefined":_typeof(BX))){var h=BX.showWait(d.previousElementSibling);BX.ajax.post("/",u,(function(e){var t=(new DOMParser).parseFromString(e,"text/html").querySelector('[data-type="key-events"]');if(document.querySelector("section[data-date]")&&document.querySelector("section[data-date]").remove(),document.querySelector('[data-type="key-events"]')&&(document.querySelector('[data-type="key-events"]').replaceWith(t),document.querySelector("#eventsSlider")))initSlider("#eventsSlider");d&&d.querySelector(".section__title")&&o&&(d.querySelector(".section__title").innerHTML="Ключевые мероприятия",o=!1),BX.closeWait(d.previousElementSibling,h)}))}}if("play"===i.dataset.type){var v=i.nextElementSibling;v.play(),v.controls=!0,i.classList.contains("hidden")||i.classList.add("hidden"),!i.dataset.action&&i.dataset.event&&videoCheck(v).then((function(e){1===e&&add_to_data_profile(i.dataset.type,i)}))}if("more"===i.dataset.type){var p=i.closest("section"),f=p.querySelector('[data-type="list"]');p.querySelector(".tns-outer")&&(sliderContainer=p.querySelector("#".concat(p.querySelector(".tns-outer").id)),f.dataset.id&&window.monthSliders&&window.monthSliders.length>0&&window.monthSliders.forEach((function(e,t){e.getInfo().container.dataset.id===f.dataset.id&&(e.destroy(),window.monthSliders.splice(t,1))}))),f.dataset.id&&(f=p.querySelector('[data-id="'.concat(f.dataset.id,'"]')));var m=i.dataset.url;void 0!==m&&load_more_results(f,m)}if("more-months"===i.dataset.type&&!i.classList.contains("all")){var y=i.closest('[data-type="key-events"]'),g=+i.dataset.pages,_=+i.dataset.current;if(_++,g>1)y.querySelectorAll('[data-page="'.concat(_,'"]')).forEach((function(e){return removeClass([e],"hidden")})),_===g&&(i.classList.add("all"),i.innerHTML="Загружено все"),i.dataset.current=_}if("show_full"===i.dataset.type){var w=i.closest(".news__item").querySelector(".news__body__hidden");w&&(toggleClass(w,"show"),w.classList.contains("show")?i.innerHTML="свернуть новость":i.innerHTML="читать дальше")}}));var i=document.querySelector('.subscription-form .form__btn[type="submit"]');i&&i.addEventListener("click",(function(e){e.preventDefault();var t=e.target.closest(".sub-form-wrapper"),n=e.target.closest("form"),a=n.querySelector('[data-type="error"]'),r={email:n.querySelector('input[name="email"]').value,company:n.querySelector('input[name="company"]').value,name:n.querySelector('input[name="name"]').value,text:n.querySelector('input[name="text"]').value,token:n.querySelector('input[name="recaptcha_token"]').value};if(validateForm(n,["name","email","check","text"])){subscribe(r),!n.classList.contains("hidden")&&n.classList.add("hidden");var o=document.createElement("p");o.classList.add("sub__text"),o.innerHTML="Теперь Вы подписаны на рассылку полезной и актуальной информации.",t.insertAdjacentElement("afterBegin",o),addClass([a],"hidden")}else removeClass([a],"hidden"),showBundle("Ошибка при заполнении формы.","attention")}));var l=document.querySelectorAll('input[name="check"]');l.length>0&&l.forEach((function(e){e.addEventListener("change",(function(e){var t=e.target,n=t.closest("form").querySelector('[type="submit"]');t.checked&&n?n.disabled&&(removeClass([n],"disabled"),n.disabled=!1):n.disabled||(addClass([n],"disabled"),n.disabled=!0)}))}));var c=document.querySelector(".burger"),d=c.closest(".header-top"),u=d.querySelector(".mobile-nav");c&&(c.addEventListener("click",(function(){c.classList.contains("open")?(c.classList.remove("open"),d.classList.remove("open")):(c.classList.add("open"),d.classList.add("open"))})),window.addEventListener("scroll",(function(){window.scrollY>100&&c.classList.contains("open")&&toggleOpen([c,d],"open")})),u.addEventListener("click",(function(e){e.target.classList.contains("mobile-nav")&&toggleOpen([c,d],"open")})));var h=document.querySelectorAll('[data-type="files"]'),v=document.querySelector('input[type="file"]');h.length>0&&v&&(h.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),e.currentTarget.parentNode.querySelector(".form__file").click()}))})),v.addEventListener("change",(function(e){var t=e.target.files[0];if(console.log(t),t.type.startsWith("image/")&&t.size<=5e6){var n=window.URL.createObjectURL(t),a=e.target.nextElementSibling;a.style.backgroundImage="url(".concat(n,")"),a.classList.contains("no__avatar")&&a.classList.remove("no__avatar")}else console.warn("Image type error!")}))),document.getElementById("animated-thumbnials")&&lightGallery(document.getElementById("animated-thumbnials"),{selector:".gallery__image",thumbnail:!0,animateThumb:!1,showThumbByDefault:!1});var p=document.querySelector('[data-type="more__img"]');p&&p.addEventListener("click",(function(e){toggleClass(e.target.closest(".gallery__wrapper"),"all")}));var f=document.querySelectorAll(".password-wrapper");0!==f.length&&f.forEach((function(e){e.addEventListener("click",(function(e){if("show-pwd"===e.target.dataset.type){var t=e.target.parentNode.querySelector("input");t.classList.contains("show__pwd")?(t.type="password",removeClass([t],"show__pwd")):(t.type="text",addClass([t],"show__pwd"))}}))})),"undefined"!=typeof BX&&"undefined"!=typeof ym&&BX.getCookie("BITRIX_SM_USER_REG")&&(ym(80017873,"reachGoal","registration"),BX.setCookie("BITRIX_SM_USER_REG","",{path:"/",expires:-100}))})),not_auth_user(),add_to_data_profile=debouncePromise(add_to_data_profile,200),currentDateEvents=debouncePromise(currentDateEvents,300),testWebP((function(e){document.querySelector("body")&&(1==e?document.querySelector("body").classList.add("webp"):(document.querySelector("body").classList.add("no-webp"),changeBackground()))}));